<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta author="yo">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
	integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
	crossorigin="anonymous">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
	integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
	crossorigin="anonymous"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular.min.js"></script>

<script src="https://kjur.github.io/jsrsasign/jsrsasign-latest-all-min.js"></script>

	<script src="app/init.js"></script>
	<script src="app/directives/navbarsDr.js"></script>
	<script src="app/services/localstorage.js"></script>
	<script src="app/services/userService.js"></script>
	<script src="app/services/todopoderosoDAO.js"></script>
	<script src="app/controllers/cartelerasController.js"></script>
	<script src="app/controllers/loginController.js"></script>
<link rel="stylesheet" href="css/main.css">
</head>
<body ng-app="cartelerasInfo">

	<div id="main">

		<div id="nav" ng-controller="loginCtl">
			<div loginnav></div>
			<div logoutnav></div>
		</div>
		<div ng-view></div>
		<div ng-controller="cartelerasCtl">
			<div id="navCarteleras" class="col-xs-12 show">
				<ul class="list-group list-unstyled" ng-repeat="cartelera in carteleras">
					<a href="#{{cartelera.titulo}}" class="col-xs-12 col-sm-4 col-md-3"
						ng-click="cambiarCartelera(cartelera)">
						<li class="list-group-item text-center">{{cartelera.titulo}}</li>
					</a>
				</ul>
			</div>
			<br>
			<h3 class="text-center" id="headerCartelera">{{carteleraActiva.titulo}}</h3>
				<div class="modal fade" id="modalInscriptos" tabindex="-1"
					role="dialog" aria-labelledby="Editar cartel">
					<div class="modal-dialog modal-lg" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"
									aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
								<h4 class="modal-title" id="modalInscriptosh4">Listado de
									inscriptos</h4>
							</div>
							<div class="modal-body">
								<ul class="list-group" ng-repeat="usuario in carteleraActiva.interesados">
									<li class="list-group-item">{{carteleraActiva.titulo}}-{{usuario.user}}</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			<div class="tab-content">
				<div class="tab-pane col-xs-12 cartelera fade in active">
					<div class="col-xs-12 opciones-cartelera">
						<div class="btn-group  btn-group-justified" role="group"
							aria-label="...">
							<div class="btn-group" role="group" ng-if="carteleraActiva.usuarioPublicar.indexOf(usuario) >= 0">
								<button class="btn btn-primary" data-toggle="modal"
									data-target="#modalCartel" data-backdrop="static"
									data-modify="false">Publicar en cartelera</button>
							</div>
							<div class="btn-group" role="group">
								<button class="btn btn-primary" data-toggle="modal"
									data-target="#modalInscriptos">Ver inscriptos</button>
							</div>
							<div class="btn-group" role="group" ng-if="interesado()">
								<button class="btn btn-success" ng-click="addInteres()">Recibir Notificaciones
								</button>
							</div>
						</div>
					</div>

					<div class="cartel cartel-resumido col-xs-12 col-md-3 col-md-offset-1" ng-repeat="anuncio in carteleraActiva.anuncios">
						<div class="cartel-header col-xs-12">
							<div class="btn-group pull-right" role="group" aria-label="...">
								<a href="#" class="editar" data-toggle="modal"
									data-target="#modalCartel"
									data-text="{{anuncio.cuerpo}}"
									data-title="{{anuncio.titulo}}" data-modify="true"
									data-backdrop="static"
									ng-if="carteleraActiva.usuarioEliminar.indexOf(usuario) >= 0"> 
									<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
								</a>
								<a href="#" class="eliminar" data-toggle="tooltip" title="Eliminar" ng-if="carteleraActiva.usuarioEliminar.indexOf(usuario) >= 0">
									<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
								</a>
							</div>
						</div>
						<div class="nota col-xs-12">
							<p class="text-center nota-titulo">{{anuncio.titulo}}</p>
							<p class="nota-texto">{{anuncio.cuerpo}}</p>
							<div class="comentario">
								<div class="col-xs-12" ng-repeat="comentario in anuncio.comentarios">
									<div class="pull-right">
										<p class="col-xs-12">{{comentario.texto}} &nbsp;{{comentario.creador.user}} @ {{comentario.fecha | date}}</p>
									</div>
								</div>
								<button id="comment-button-{{$index}}"
									class="btn btn-info collapsed center-block boton-comentar"
									data-toggle="collapse" data-target="#comment-box-{{$index}}"
									aria-expanded="false">Comentar</button>

								<form id="comment-box-{{$index}}" class="collapse form-comentar">
									<div class="form-group">
										<label for="exampleInputEmail1">Comentar:</label>
										<textarea class="form-control" rows="3"></textarea>
									</div>
									<div class="form-group">
										<button type="submit" class="btn btn-default center-block">Enviar</button>
									</div>
								</form>
							</div>
						</div>
						<div class="cartel-footer col-xs-12">
							<a href="#" class="pull-right"
								onClick="mostrarArticulo(this.parentNode.parentNode);">Ver
								mas</a>
						</div>
					</div>

				</div>

			</div>
		</div>

		<script>
		
		function mostrarArticulo( node ){
			$(node).toggleClass("col-md-3");
			$(node).toggleClass("col-md-offset-1");
			$(node).toggleClass("cartel-resumido");
		}
		
		$('[data-toggle="tooltip"]').tooltip(); 
		function noClick(event){
			event.preventDefault();
		}
                
                function toogleLoguear(){
                    $("#logueado").toggleClass("hidden");
                    $("#sinloguear").toggleClass("hidden");
                }
	</script>



		<!-- modal de los carteles para editar/crear -->

		<div class="modal fade" id="modalCartel" tabindex="-1" role="dialog"
			aria-labelledby="Editar cartel">
			<div class="modal-dialog modal-lg" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="modalCartelHeader">Nuevo Cartel</h4>
					</div>
					<div class="modal-body">
						<form enctype="multipart/form-data">
							<div class="form-group">
								<label for="modalCartelTitulo" class="control-label">Titulo:</label>
								<input type="text" class="form-control" id="modalCartelTitulo">
							</div>
							<div class="form-group">
								<label for="modalCartelText" class="control-label">Contenido:</label>
								<textarea class="form-control" id="modalCartelText" rows="6"></textarea>
							</div>
							<div class="form-group">
								<label for="" class="control-label">Comentarios:</label> <label
									class="radio-inline" for="inlineRadio1"> <input
									type="radio" name="comentariosHabilitados" id="inlineRadio1"
									value="0" checked>Habilitado
								</label> <label class="radio-inline" for="inlineRadio2"> <input
									type="radio" name="comentariosHabilitados" id="inlineRadio2"
									value="1">Deshabilitado
								</label>
							</div>
							<div class="form-group">
								<label for="imagenes" class="control-label">Im&aacute;genes
									anexas:</label> <input id='imagenes' name="imagenes[]"
									class="btn btn-default" type="file" accept="image/*" multiple>
							</div>
							<div class="form-group">
								<label for="links" class="control-label">Links anexos:</label>
								<div id="links">
									<div class="input-group">
										<div class="input-group-addon">
											<span class="glyphicon glyphicon-link"></span>
										</div>
										<input name="links[]" class="form-control" type="text">
									</div>
								</div>
								<a href="#" class="btn btn-primary btn-block"
									onclick="agregarLink()"> <span
									class="glyphicon glyphicon-link"></span> <span
									class="glyphicon glyphicon-plus"></span>
								</a>
								<script>
		                    	function agregarLink(){
		                    		$("#links").append( '<div class="input-group">'+
															'<div class="input-group-addon">'+
																'<span class="glyphicon glyphicon-link"></span>'+
															'</div>'+
															'<input name="links[]" class="form-control" type="text">'+
														'</div>' 
									);
		                    	}
		                    </script>
							</div>
							<div class="form-group">
								<label for="links" class="control-label">Videos:</label>
								<div id="linksVideos">
									<div class="input-group">
										<div class="input-group-addon">
											<span class="glyphicon glyphicon-facetime-video"></span>
										</div>
										<input name="links[]" class="form-control" type="text">
									</div>

								</div>
								<a href="#" class="btn btn-primary btn-block"
									onclick="agregarLinkVideo()"> <span
									class="glyphicon glyphicon-facetime-video"></span> <span
									class="glyphicon glyphicon-plus"></span>
								</a>
								<script>
		                    	function agregarLinkVideo(){
		                    		$("#linksVideos").append( '<div class="input-group">'+
																	'<div class="input-group-addon">'+
																	'<span class="glyphicon glyphicon-facetime-video"></span>'+
																'</div>'+
																'<input name="links[]" class="form-control" type="text">'+
															'</div>' 
									);
		                    	}
		                    </script>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
						<button type="button" class="btn btn-primary"
							id="modalCartelEnviar">Publicar</button>
					</div>
				</div>
			</div>
		</div>
		
		<script>
		$('#modalCartel').on('show.bs.modal', function (event) {
				var button = $(event.relatedTarget) // Button that triggered the modal
				var title = button.data('title');
				var text = button.data('text');
				var modify = button.data('modify');
			  
				// If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
				// Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
				var header = "Nuevo Cartel";
				var enviar = "Publicar";
				if( modify == true ){
					header = "Modificar Cartel";
					enviar = "Guardar cambios";	
				}
				
				var modal = $(this);
				modal.find('.modal-title').text(header);
				modal.find('#modalCartelEnviar').text(enviar);
				modal.find('#modalCartelTitulo').val(title);
				modal.find('#modalCartelText').val(text);
		})
	</script>


		<div class="modal fade" id="modalNuevoUsuario" tabindex="-1"
			role="dialog" aria-labelledby="Nuevo usuario">
			<div class="modal-dialog modal-lg" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="modalHeader">Nuevo Usuario</h4>
					</div>
					<div class="modal-body">
						<form>
							<div class="form-group">
								<label for="modalNuevoUsuarioNombre" class="control-label">Usuario:</label>
								<input type="text" class="form-control"
									id="modalNuevoUsuarioNombre" name="user">
							</div>
							<div class="form-group">
								<label for="modalNuevoUsuarioContra" class="control-label">Contrase&ntilde;a:</label>
								<input type="password" class="form-control"
									id="modalNuevoUsuarioContra" name="pass">
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
						<button type="button" class="btn btn-primary"
							id="modalNuevoUsuarioEnviar">Registrarse</button>
					</div>
				</div>
			</div>
		</div>
</body>
</html>
